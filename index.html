<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nadine's Memory Puzzle</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --case: #2d3436; --accent: #fd79a8; /* Warna Retro */
            --hd-bg: #1a1a2e; --hd-text: #eaeaea; /* Warna HD Final */
        }
        * { box-sizing: border-box; touch-action: manipulation; user-select: none; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; background: #111; 
            font-family: 'Press Start 2P', cursive; color: white;
            display: flex; align-items: center; justify-content: center;
            height: 100vh; overflow: hidden;
        }

        /* --- RETRO CONSOLE FRAME --- */
        #console-frame {
            width: 380px; height: 750px;
            background: var(--case);
            border-radius: 30px; padding: 25px;
            box-shadow: inset 0 -10px 20px rgba(0,0,0,0.5), 0 10px 30px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; border: 5px solid #000;
            position: relative;
        }
        .decor-line { height: 5px; background: var(--accent); margin-bottom: 15px; opacity: 0.7; }

        /* --- SCREEN AREA --- */
        #screen-container {
            flex: 1; background: #000; border-radius: 10px;
            border: 4px solid #555; overflow: hidden; position: relative;
            display: flex; flex-direction: column;
        }

        #game-ui {
            height: 50px; background: #333; border-bottom: 3px solid #555;
            display: flex; align-items: center; justify-content: space-between; padding: 0 15px; font-size: 10px;
        }

        /* --- PUZZLE GRID (ASPEK HD) --- */
        #puzzle-area {
            flex: 1; background: #222; display: flex; align-items: center; justify-content: center; padding: 10px;
        }
        #puzzle-grid {
            display: grid;
            /* Grid akan diatur via JS (3x3 atau 4x4) */
            width: 300px; height: 300px;
            background: #444; border: 3px solid var(--accent);
            box-shadow: 0 0 20px rgba(253, 121, 168, 0.3);
        }
        .puzzle-piece {
            width: 100%; height: 100%;
            background-size: 300px 300px; /* Harus sama dengan ukuran grid */
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.2s, border-color 0.2s; /* Smooth Transition */
        }
        .puzzle-piece.selected {
            border: 3px solid #fff;
            transform: scale(0.95);
            z-index: 10;
            box-shadow: 0 0 15px #fff;
        }

        /* --- OVERLAYS (Start, Win, Final) --- */
        .overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.92); z-index: 50;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 20px;
        }

        /* Final Screen - Proper HD Look */
        #final-screen {
            background: var(--hd-bg) !important; /* Override retro bg */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Font HD */
        }
        #final-content {
            background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            width: 90%; max-height: 70%; overflow-y: auto;
        }
        #final-msg {
            font-size: 14px; line-height: 1.6; color: var(--hd-text); text-align: left; white-space: pre-wrap;
        }

        /* Buttons */
        .retro-btn {
            margin-top: 25px; padding: 15px 30px; font-family: 'Press Start 2P', cursive;
            font-size: 10px; background: var(--accent); color: #000; border: none;
            border-bottom: 5px solid #c44569; cursor: pointer; transition: all 0.1s;
        }
        .retro-btn:active { transform: translateY(4px); border-bottom: 1px solid transparent; }
    </style>
</head>
<body>

<div id="console-frame">
    <div class="decor-line"></div>
    <div style="text-align: center; font-size: 10px; margin-bottom: 10px; color: #888;">PUZZLEE NADINEEE</div>
    
    <div id="screen-container">
        <div id="game-ui">
            <div id="level-txt">LEVEL 1/3</div>
            <div>MODE: SWAP</div>
        </div>

        <div id="puzzle-area">
            <div id="main-grid"></div>
        </div>

        <div id="start-screen" class="overlay">
            <h1 style="font-size: 16px; color: var(--accent); line-height: 1.5; margin-bottom: 30px;">NADINE'S<br>PUZZLE</h1>
            <p style="font-size: 8px; color: #ccc; line-height: 1.6; max-width: 80%;">
                rakitt fotonyaa biarr jadii satuu.<br><br>
                
            </p>
            <button class="retro-btn" onclick="startGame()">START MISSION</button>
        </div>

        <div id="win-screen" class="overlay" style="display:none;">
            <h2 style="color:#55efc4; font-size: 14px; margin-bottom: 20px;">WIHH CANTIKNYAA NADINE! ‚ú®</h2>
            <div id="preview-img" style="width:150px; height:150px; background:#333; border:3px solid #fff; margin-bottom:20px; background-size:cover;"></div>
            <button class="retro-btn" onclick="nextLevel()">LEVEL SELANJUTNYA</button>
        </div>

        <div id="final-screen" class="overlay" style="display:none;">
            <h3 style="color: var(--accent); font-family: 'Press Start 2P'; font-size: 12px; margin-bottom: 20px;">MISSION COMPLETE ‚ù§Ô∏è</h3>
            <div id="final-content">
                <div id="final-msg"></div>
            </div>
            <button class="retro-btn" style="font-family: 'Press Start 2P'; margin-top: 20px;" onclick="location.reload()">REPLAY MEMORIES</button>
        </div>
    </div>
    
    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px; opacity: 0.5;">
         <div style="width: 40px; height: 10px; background: #000; border-radius: 5px;"></div>
         <div style="width: 40px; height: 10px; background: #000; border-radius: 5px;"></div>
    </div>
</div>

<script>
    // =========================================
    // AREA UNTUK MENGGANTI FOTO DAN TEKS
    // =========================================

    // Masukkan 3 Link Foto Kalian di sini (Sebaiknya foto persegi/square biar rapi)
    const puzzleImages = [
        "https://img.sanishtech.com/u/9be2087b5c1eb848edf5a2e612dec634.jpg", 
        "https://img.sanishtech.com/u/d51129b148cd4e55bfab5924fa3ad3aa.jpg", 
        "https://img.sanishtech.com/u/33751ff2705c26bdb5b8850c9b0b3e99.jpg" 
    ];

    // Ganti Longtext di sini (Bisa pakai emoji dan enter)
    const finalMessageText = `HAAIII SAYANGKUU CINTAKUUUU

WIHHHH SERUU BANGETT KANN PASANG PASANGNYAA HEHEHEE TAPI SEMOGA FOTONYA MUNCUL DI KAMUU YAAA SAYANGG HEHEHEE.. MINTAA MAAF YAA KALAU TETEP BIKIN INII BUAT KAMUUU, INI BUKAN GAME KOK TAPI PUZZLE WKWKWKWKWK.. YAA AK BIKIN KARENAA PENGEN AJAA SIEE HEHEHEE..

WAWWW SERUU BANGET BANGET BANGETT YAAA HARI INIII, akhirrnyaaa bisa menamatkann arduinoo withh uuu yaakkkk heheheheee, salah satu wishlistku darii awal kelas 12 akhirnyaa tercapaiii, yaa walaupun beda kelompokk tapii terimakasihh banyakk yaaa udaaa sama samaaa membuatt arduino inii, ak senengg bangett dee hari inii, darii pagii bisaa bantuin kamu untuk hafalann, dan alhamdulillah dapet 94 wooiii kerenn bangett sumpah sumpaahhh, teruss akhirnyaa kitaa bisaa bersamaa lagii untuk memgerjakann arduinonyaaaa, shajaisjshaja ak ga nyangkaaa bisaa membuatt arduinoo sebaguss ituuu, yaa walaupun simpeell tapi aku banggaa bangett deh bisaa bikinn hal yang sangatt worth it untuk di buaatt.. yaapss semogaa besok lancarr sampai jadii tong sampah fullnyaa yaaaa sayangg aamiinn.. teruss ak jugaa seneng hehehee bisaa holding hands di tengah keramaiann tadii wkekwkkwwk.. seruu bangett deh ceritaa kitaa tuuhh wkkwwk.. ak sangatt senengg bangett hari iniii

daannn aku mau mintaa maaff yaaa kalau hari ini malah ga bantuinn kamu buatt infografisnyaaa, huhuhuu malah ku tinggal boboo ihh jahat bangettt, sedangkan kamu berjuang sendirii menggendong kelompokk.. dann sumpaahh hasilnyaa sangatt baguss sekalii dehh seriusss, bener benerr pembuat infografiss ter the bestt yang pernah aku lihaatt dehh, kamu harusnyaa bisa upload template di canvaa ataupunn menjual templaate di mana punn ituu lhoo ciyuss dehhh.. keren se keren kerennyaa nadine syakira putrii tuhhh sumpahh dehh.. sekalii lagi terimakasihh dan minta maaf sebanyak banyakknyaa yaaa, karenaa aku ga bantuinn kamuu malah ninggal boboo hdjsjsjxsjsjsk

Yasudaaa mungkin jugaa kamu udaa kecapeann hari inii sangat kerennn, jadii kamu udsa ketidurann yakkk.. yasudaa selamatt beristirahatt yaa sayangkuu cintakuu.. sumpaa sekali lagii terimakasih banyak yaa buat hari iniii, semogaaa kitaa masihh bisaa teruss bersama samaa lagii kedepannyaa dan melakukan hal hall se kerenn hari ini lagii kedepannyaa yaaaa.. aku hanggaa banget punyaa kamu sumpaa dehh sayangg, hdjsjsisjsjsis sangatt amat banggaaa pokoknyaaaaa.. okeeyydeee waktunyaa boboo yaaaa.. goodnighttt yaaaa cantikkuu pinterrkuuu.. semogaa kitaa bisaa seru seruan lagii besokkk. apalagii ada campus expoo yaaa, kitaa jalan jalann yuuu.. semogaa bisaa yaapss aamiin.. yuppsss paopaii paipaiii sayangggg.. 

je t'aimeee bieennn nadinee syakiraa prettyyy, sayangg kamu banyak banyakkkü©µüíôü©µüíôü©µüíôü©µüíôü©µüíôü©µüíôü©µüíô
- Fathan Fahreza`;

    // =========================================
    // CORE GAME LOGIC
    // =========================================

    let currentLevel = 0;
    let gridSize = 3; // Default 3x3
    let pieces = []; // Array menyimpan posisi asli
    let selectedPieceIndex = null;
    let isAnimating = false;
    let audioCtx;

    const gridEl = document.getElementById('puzzle-grid');
    const mainGridContainer = document.getElementById('puzzle-area');

    // --- AUDIO SYSTEM (RETRO SFX) ---
    function playTone(freq, type, duration, vol = 0.1) {
        if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        g.gain.setValueAtTime(vol, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
        osc.connect(g); g.connect(audioCtx.destination);
        osc.start(); osc.stop(audioCtx.currentTime + duration);
    }
    function sfxTap() { playTone(400, 'square', 0.1, 0.05); }
    function sfxSwap() { playTone(600, 'sine', 0.15, 0.08); }
    function sfxWin() { 
        playTone(523.25, 'triangle', 0.2); 
        setTimeout(() => playTone(659.25, 'triangle', 0.2), 150);
        setTimeout(() => playTone(783.99, 'triangle', 0.4), 300);
    }

    // --- GAME FUNCTIONS ---
    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        sfxWin(); // Start sound
        loadLevel(0);
    }

    function loadLevel(idx) {
        currentLevel = idx;
        // Level 1 & 2: 3x3. Level 3: 4x4.
        gridSize = (idx < 2) ? 3 : 4; 
        document.getElementById('level-txt').innerText = `LEVEL ${idx+1}/3`;
        
        setupGrid();
    }

    function setupGrid() {
        mainGridContainer.innerHTML = '<div id="puzzle-grid"></div>'; // Reset container
        const grid = document.getElementById('puzzle-grid');
        
        // Atur CSS Grid
        grid.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
        grid.style.gridTemplateRows = `repeat(${gridSize}, 1fr)`;

        const totalPieces = gridSize * gridSize;
        pieces = [];
        
        // 1. Buat array posisi asli (0, 1, 2, ... n)
        for (let i = 0; i < totalPieces; i++) pieces.push(i);
        
        // 2. Acak array (Fisher-Yates Shuffle)
        for (let i = pieces.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [pieces[i], pieces[j]] = [pieces[j], pieces[i]];
        }

        // 3. Render potongan ke layar
        renderPieces(grid);
    }

    function renderPieces(grid) {
        grid.innerHTML = '';
        const pieceSize = 300 / gridSize; // Ukuran dalam px
        const currentImage = puzzleImages[currentLevel];

        pieces.forEach((originalPos, currentIdx) => {
            const piece = document.createElement('div');
            piece.className = 'puzzle-piece';
            piece.style.backgroundImage = `url('${currentImage}')`;
            
            // Hitung posisi background berdasarkan posisi asli
            const row = Math.floor(originalPos / gridSize);
            const col = originalPos % gridSize;
            piece.style.backgroundPosition = `-${col * pieceSize}px -${row * pieceSize}px`;
            
            piece.dataset.index = currentIdx;
            piece.onclick = () => handlePieceClick(currentIdx);
            grid.appendChild(piece);
        });
    }

    function handlePieceClick(clickedIndex) {
        if (isAnimating) return;
        sfxTap();

        const pieceElements = document.querySelectorAll('.puzzle-piece');

        if (selectedPieceIndex === null) {
            // Klik pertama: Pilih
            selectedPieceIndex = clickedIndex;
            pieceElements[clickedIndex].classList.add('selected');
        } else if (selectedPieceIndex === clickedIndex) {
            // Klik lagi di tempat sama: Batal pilih
            pieceElements[selectedPieceIndex].classList.remove('selected');
            selectedPieceIndex = null;
        } else {
            // Klik kedua: Tukar!
            swapPieces(selectedPieceIndex, clickedIndex);
        }
    }

    function swapPieces(idx1, idx2) {
        isAnimating = true;
        sfxSwap();
        const pieceElements = document.querySelectorAll('.puzzle-piece');
        pieceElements[idx1].classList.remove('selected');

        // Tukar data di array
        [pieces[idx1], pieces[idx2]] = [pieces[idx2], pieces[idx1]];

        // Render ulang (cara paling aman untuk visualisasi tukar)
        // setTimeout agar efek selected hilang dulu
        setTimeout(() => {
            renderPieces(document.getElementById('puzzle-grid'));
            selectedPieceIndex = null;
            isAnimating = false;
            checkWin();
        }, 200);
    }

    function checkWin() {
        // Cek apakah array pieces sudah urut (0, 1, 2, ...)
        const isSorted = pieces.every((val, index) => val === index);
        
        if (isSorted) {
            setTimeout(() => {
                sfxWin();
                if (currentLevel < 2) {
                    // Show Level Complete Screen
                    const winScreen = document.getElementById('win-screen');
                    winScreen.style.display = 'flex';
                    // Tampilkan preview foto yang berhasil disusun
                    document.getElementById('preview-img').style.backgroundImage = `url('${puzzleImages[currentLevel]}')`;
                } else {
                    // Final Level Done!
                    finishGame();
                }
            }, 500);
        }
    }

    function nextLevel() {
        document.getElementById('win-screen').style.display = 'none';
        loadLevel(currentLevel + 1);
    }

    // --- FINAL SCREEN LOGIC (TYPEWRITER EFFECT) ---
    function finishGame() {
        const finalScreen = document.getElementById('final-screen');
        finalScreen.style.display = 'flex';
        
        const msgEl = document.getElementById('final-msg');
        msgEl.innerHTML = "";
        let i = 0;
        function typeWriter() {
            if(i < finalMessageText.length) {
                // Sound effect mengetik halus
                playTone(200, 'sine', 0.05, 0.02); 
                msgEl.innerHTML += finalMessageText.charAt(i) === '\n' ? '<br>' : finalMessageText.charAt(i);
                i++;
                setTimeout(typeWriter, 50); // Kecepatan mengetik
            }
        }
        // Delay sedikit sebelum mulai mengetik
        setTimeout(typeWriter, 1000);
    }
</script>
</body>
</html>
